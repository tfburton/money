(function() {
  var Mixin, Module, Signal, def, _base,
    __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; },
    __slice = [].slice;

  this.neat || (this.neat = {});

  (_base = this.neat).core || (_base.core = {});

  /* src/core/types/utils.coffee */;


  def = function(ctor, o) {
    var name, value, _results;
    _results = [];
    for (name in o) {
      value = o[name];
      _results.push(typeof Object.defineProperty === "function" ? Object.defineProperty(ctor.prototype, name, {
        enumerable: false,
        value: value,
        writable: true
      }) : void 0);
    }
    return _results;
  };

  /* src/core/types/object.coffee */;


  Object["new"] = function(a) {
    var o;
    o = {};
    a.step(2, function(k, v) {
      return o[k] = v;
    });
    return o;
  };

  def(Object, {
    concat: function(m) {
      var k, o, v;
      o = {};
      for (k in this) {
        v = this[k];
        o[k] = v;
      }
      return o.merge(m || {});
    }
  });

  def(Object, {
    destroy: function(key) {
      var res;
      if (this.hasKey(key)) {
        res = this[key];
        delete this[key];
        return res;
      }
      return null;
    }
  });

  def(Object, {
    each: function(f) {
      var k, v;
      if (f != null) {
        for (k in this) {
          v = this[k];
          f(k, v);
        }
      }
      return this;
    }
  });

  def(Object, {
    empty: function() {
      return this.keys().empty();
    }
  });

  def(Object, {
    first: function() {
      if (this.empty()) {
        return null;
      } else {
        return this.flatten().group(2).first();
      }
    }
  });

  def(Object, {
    flatten: function() {
      var a, k, v;
      a = [];
      for (k in this) {
        v = this[k];
        a = a.concat([k, v]);
      }
      return a;
    }
  });

  def(Object, {
    has: function(value) {
      return __indexOf.call(this.values(), value) >= 0;
    }
  });

  def(Object, {
    hasKey: function(key) {
      return this[key] != null;
    }
  });

  def(Object, {
    keys: function() {
      var k, _results;
      _results = [];
      for (k in this) {
        _results.push(k);
      }
      return _results;
    }
  });

  def(Object, {
    length: function() {
      return this.keys().length;
    }
  });

  def(Object, {
    last: function() {
      if (this.empty()) {
        return null;
      } else {
        return this.flatten().group(2).last();
      }
    }
  });

  def(Object, {
    map: function(f) {
      var k, v;
      return Object["new"](((function() {
        var _results;
        _results = [];
        for (k in this) {
          v = this[k];
          _results.push(f(k, v));
        }
        return _results;
      }).call(this)).flatten());
    }
  });

  def(Object, {
    merge: function(o) {
      var k, v;
      for (k in o) {
        v = o[k];
        this[k] = v;
      }
      return this;
    }
  });

  def(Object, {
    reject: function(f) {
      var k, o, v;
      o = {};
      for (k in this) {
        v = this[k];
        if (!(typeof f === "function" ? f(k, v) : void 0)) {
          o[k] = v;
        }
      }
      return o;
    }
  });

  def(Object, {
    select: function(f) {
      var k, o, v;
      o = {};
      for (k in this) {
        v = this[k];
        if (typeof f === "function" ? f(k, v) : void 0) {
          o[k] = v;
        }
      }
      return o;
    }
  });

  def(Object, {
    size: function() {
      return this.length();
    }
  });

  def(Object, {
    sort: function(f) {
      var k, o, _i, _len, _ref;
      if (!(f != null) || typeof f !== 'function') {
        f = function(a, b) {
          if (a > b) {
            return 1;
          } else if (b < a) {
            return -1;
          } else {
            return 0;
          }
        };
      }
      o = {};
      _ref = this.keys().sort(f);
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        k = _ref[_i];
        o[k] = this[k];
      }
      return o;
    }
  });

  def(Object, {
    sortedKeys: function() {
      return this.keys().sort();
    }
  });

  def(Object, {
    sortedValues: function() {
      var k, _i, _len, _ref, _results;
      _ref = this.sortedKeys();
      _results = [];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        k = _ref[_i];
        _results.push(this[k]);
      }
      return _results;
    }
  });

  def(Object, {
    type: function() {
      return Object.prototype.toString.call(this).toLowerCase().replace(/\[object (\w+)\]/, "$1");
    }
  });

  def(Object, {
    update: Object.prototype.merge
  });

  def(Object, {
    values: function() {
      var k, _i, _len, _ref, _results;
      _ref = this.keys();
      _results = [];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        k = _ref[_i];
        _results.push(this[k]);
      }
      return _results;
    }
  });

  def(Object, {
    quacksLike: function(type) {
      var definition, k, v, _ref;
      if (type.__definition__ != null) {
        definition = type.__definition__;
        if (typeof definition === "function") {
          return definition(this);
        }
        for (k in definition) {
          v = definition[k];
          switch (typeof v) {
            case "function":
              if (!v(this[k])) {
                return false;
              }
              break;
            default:
              if (!(v === "*" || ((_ref = this[k]) != null ? _ref.type() : void 0) === v)) {
                return false;
              }
          }
        }
        return true;
      } else {
        return false;
      }
    }
  });

  /* src/core/types/number.coffee */;


  def(Number, {
    ago: function() {
      return new Date(new Date().getTime() - this.valueOf());
    }
  });

  def(Number, {
    days: function() {
      return this.hours() * 24;
    }
  });

  def(Number, {
    even: function() {
      return this.valueOf() % 2 === 0;
    }
  });

  def(Number, {
    fromNow: function() {
      return new Date(new Date().getTime() + this.valueOf());
    }
  });

  def(Number, {
    hours: function() {
      return this.minutes() * 60;
    }
  });

  Number.later = function() {
    return this.fromNow();
  };

  def(Number, {
    minutes: function() {
      return this.seconds() * 60;
    }
  });

  def(Number, {
    odd: function() {
      return this.valueOf() % 2 === 1;
    }
  });

  def(Number, {
    seconds: function() {
      return this.valueOf() * 1000;
    }
  });

  def(Number, {
    times: function(target) {
      var i, o, _i, _ref;
      if (typeof target === "function") {
        return (function() {
          var _i, _ref, _results;
          _results = [];
          for (i = _i = 0, _ref = this.valueOf() - 1; 0 <= _ref ? _i <= _ref : _i >= _ref; i = 0 <= _ref ? ++_i : --_i) {
            _results.push(target(i));
          }
          return _results;
        }).call(this);
      }
      o = target;
      for (i = _i = 1, _ref = this.valueOf() - 1; 1 <= _ref ? _i <= _ref : _i >= _ref; i = 1 <= _ref ? ++_i : --_i) {
        if (Array.isArray(o)) {
          o = o.concat(target);
        } else {
          o += target;
        }
      }
      return o;
    }
  });

  def(Number, {
    to: function(end, callback) {
      var i, _i, _ref, _results;
      _results = [];
      for (i = _i = _ref = this.valueOf(); _ref <= end ? _i <= end : _i >= end; i = _ref <= end ? ++_i : --_i) {
        _results.push(callback(i));
      }
      return _results;
    }
  });

  def(Number, {
    weeks: function() {
      return this.days() * 7;
    }
  });

  /* src/core/types/string.coffee */;


  def(String, {
    append: function(str) {
      return "" + this + str;
    }
  });

  def(String, {
    camelize: function() {
      var a, s, w, _i, _len;
      a = this.toLowerCase().split(/[_\s-]/);
      s = a.shift();
      for (_i = 0, _len = a.length; _i < _len; _i++) {
        w = a[_i];
        s = "" + s + (w.capitalize());
      }
      return s;
    }
  });

  def(String, {
    capitalize: function() {
      return this.toLowerCase().replace(/^[a-z]/, function(m) {
        return m.toUpperCase();
      });
    }
  });

  def(String, {
    capitalizeAll: function() {
      return this.toLowerCase().replace(/(^|\s)([a-z])/g, function(m, a, b) {
        return "" + a + (b.toUpperCase());
      });
    }
  });

  def(String, {
    center: function(width, pad) {
      var padLeftLength, padRightLength;
      if (width == null) {
        width = 0;
      }
      if (pad == null) {
        pad = ' ';
      }
      if (width > this.length) {
        padLeftLength = Math.floor((width - this.length) / 2);
        padRightLength = width - this.length - padLeftLength;
        return this.padLeft(padLeftLength, pad).padRight(padRightLength, pad);
      } else {
        return this.valueOf();
      }
    }
  });

  def(String, {
    compact: function() {
      return this.replace(/\s+/g, '');
    }
  });

  def(String, {
    empty: function() {
      return this.length === 0;
    }
  });

  def(String, {
    left: function(l) {
      return this.padRight(l - this.length);
    }
  });

  def(String, {
    padLeft: function(length, pad) {
      if (length == null) {
        length = 0;
      }
      if (pad == null) {
        pad = ' ';
      }
      return this.prepend(String.fill(length, pad));
    }
  });

  def(String, {
    padRight: function(length, pad) {
      if (length == null) {
        length = 0;
      }
      if (pad == null) {
        pad = ' ';
      }
      return this.append(String.fill(length, pad));
    }
  });

  def(String, {
    prepend: function(str) {
      return "" + str + this;
    }
  });

  def(String, {
    parameterize: function() {
      return this.nopunctuation().nodiacritics().toLowerCase().squeeze().replace(/\s/g, '-');
    }
  });

  def(String, {
    right: function(l) {
      return this.padLeft(l - this.length);
    }
  });

  def(String, {
    squeeze: function(match) {
      var a, e, m, rangeRe, re, s, _ref;
      if (match == null) {
        match = '\\s';
      }
      rangeRe = /^([A-Za-z_])-([A-Za-z])$/;
      re = null;
      if (rangeRe.test(match)) {
        _ref = rangeRe.exec(match), m = _ref[0], s = _ref[1], e = _ref[2];
        a = [];
        s.to(e, function(c) {
          return a.push("" + c + "+");
        });
        re = RegExp("" + (a.join('|')), "g");
      } else if (match === '\\s') {
        re = /\n+| +|\t+/g;
      } else {
        re = RegExp("(" + match + ")+", "g");
        return this.replace(re, function(m, w) {
          return w;
        });
      }
      return this.replace(re, function(m) {
        return m.substr(0, 1);
      });
    }
  });

  def(String, {
    strip: function() {
      return this.replace(/^\s+|\s+$/g, '');
    }
  });

  def(String, {
    to: function(end, callback) {
      var i, start, _i, _results;
      start = this.charCodeAt(0);
      end = end.charCodeAt(0);
      _results = [];
      for (i = _i = start; start <= end ? _i <= end : _i >= end; i = start <= end ? ++_i : --_i) {
        _results.push(callback(String.fromCharCode(i)));
      }
      return _results;
    }
  });

  def(String, {
    underscore: function() {
      return this.replace(/([a-z])([A-Z])/g, "$1_$2").split(/[-/]|\s/g).join("_").toLowerCase();
    }
  });

  def(String, {
    nodiacritics: function() {
      var k, str, v, _ref;
      str = this;
      _ref = String.DACRITICS_MAP;
      for (k in _ref) {
        v = _ref[k];
        str = str.replace(v, k);
      }
      return str;
    }
  });

  def(String, {
    nopunctuation: function() {
      return this.replace(/[,?;.:/!ยง*%=\[\](){}'"`\\_<>-]/g, '');
    }
  });

  String.fill = function(length, filler) {
    var fillerChar, i, s, _i, _ref;
    if (filler == null) {
      filler = ' ';
    }
    s = '';
    fillerChar = 0;
    for (i = _i = 0, _ref = length - 1; 0 <= _ref ? _i <= _ref : _i >= _ref; i = 0 <= _ref ? ++_i : --_i) {
      s = "" + s + filler[fillerChar++];
      if (fillerChar >= filler.length) {
        fillerChar = 0;
      }
    }
    return s;
  };

  String.DACRITICS_MAP = {
    A: /[\u0041\u24B6\uFF21\u00C0\u00C1\u00C2\u1EA6\u1EA4\u1EAA\u1EA8\u00C3\u0100\u0102\u1EB0\u1EAE\u1EB4\u1EB2\u0226\u01E0\u00C4\u01DE\u1EA2\u00C5\u01FA\u01CD\u0200\u0202\u1EA0\u1EAC\u1EB6\u1E00\u0104\u023A\u2C6F]/g,
    AA: /[\uA732]/g,
    AE: /[\u00C6\u01FC\u01E2]/g,
    AO: /[\uA734]/g,
    AU: /[\uA736]/g,
    AV: /[\uA738\uA73A]/g,
    AY: /[\uA73C]/g,
    B: /[\u0042\u24B7\uFF22\u1E02\u1E04\u1E06\u0243\u0182\u0181]/g,
    C: /[\u0043\u24B8\uFF23\u0106\u0108\u010A\u010C\u00C7\u1E08\u0187\u023B\uA73E]/g,
    D: /[\u0044\u24B9\uFF24\u1E0A\u010E\u1E0C\u1E10\u1E12\u1E0E\u0110\u018B\u018A\u0189\uA779]/g,
    DZ: /[\u01F1\u01C4]/g,
    Dz: /[\u01F2\u01C5]/g,
    E: /[\u0045\u24BA\uFF25\u00C8\u00C9\u00CA\u1EC0\u1EBE\u1EC4\u1EC2\u1EBC\u0112\u1E14\u1E16\u0114\u0116\u00CB\u1EBA\u011A\u0204\u0206\u1EB8\u1EC6\u0228\u1E1C\u0118\u1E18\u1E1A\u0190\u018E]/g,
    F: /[\u0046\u24BB\uFF26\u1E1E\u0191\uA77B]/g,
    G: /[\u0047\u24BC\uFF27\u01F4\u011C\u1E20\u011E\u0120\u01E6\u0122\u01E4\u0193\uA7A0\uA77D\uA77E]/g,
    H: /[\u0048\u24BD\uFF28\u0124\u1E22\u1E26\u021E\u1E24\u1E28\u1E2A\u0126\u2C67\u2C75\uA78D]/g,
    I: /[\u0049\u24BE\uFF29\u00CC\u00CD\u00CE\u0128\u012A\u012C\u0130\u00CF\u1E2E\u1EC8\u01CF\u0208\u020A\u1ECA\u012E\u1E2C\u0197]/g,
    J: /[\u004A\u24BF\uFF2A\u0134\u0248]/g,
    K: /[\u004B\u24C0\uFF2B\u1E30\u01E8\u1E32\u0136\u1E34\u0198\u2C69\uA740\uA742\uA744\uA7A2]/g,
    L: /[\u004C\u24C1\uFF2C\u013F\u0139\u013D\u1E36\u1E38\u013B\u1E3C\u1E3A\u0141\u023D\u2C62\u2C60\uA748\uA746\uA780]/g,
    LJ: /[\u01C7]/g,
    Lj: /[\u01C8]/g,
    M: /[\u004D\u24C2\uFF2D\u1E3E\u1E40\u1E42\u2C6E\u019C]/g,
    N: /[\u004E\u24C3\uFF2E\u01F8\u0143\u00D1\u1E44\u0147\u1E46\u0145\u1E4A\u1E48\u0220\u019D\uA790\uA7A4]/g,
    NJ: /[\u01CA]/g,
    Nj: /[\u01CB]/g,
    O: /[\u004F\u24C4\uFF2F\u00D2\u00D3\u00D4\u1ED2\u1ED0\u1ED6\u1ED4\u00D5\u1E4C\u022C\u1E4E\u014C\u1E50\u1E52\u014E\u022E\u0230\u00D6\u022A\u1ECE\u0150\u01D1\u020C\u020E\u01A0\u1EDC\u1EDA\u1EE0\u1EDE\u1EE2\u1ECC\u1ED8\u01EA\u01EC\u00D8\u01FE\u0186\u019F\uA74A\uA74C]/g,
    OI: /[\u01A2]/g,
    OO: /[\uA74E]/g,
    OU: /[\u0222]/g,
    P: /[\u0050\u24C5\uFF30\u1E54\u1E56\u01A4\u2C63\uA750\uA752\uA754]/g,
    Q: /[\u0051\u24C6\uFF31\uA756\uA758\u024A]/g,
    R: /[\u0052\u24C7\uFF32\u0154\u1E58\u0158\u0210\u0212\u1E5A\u1E5C\u0156\u1E5E\u024C\u2C64\uA75A\uA7A6\uA782]/g,
    S: /[\u0053\u24C8\uFF33\u1E9E\u015A\u1E64\u015C\u1E60\u0160\u1E66\u1E62\u1E68\u0218\u015E\u2C7E\uA7A8\uA784]/g,
    T: /[\u0054\u24C9\uFF34\u1E6A\u0164\u1E6C\u021A\u0162\u1E70\u1E6E\u0166\u01AC\u01AE\u023E\uA786]/g,
    TZ: /[\uA728]/g,
    U: /[\u0055\u24CA\uFF35\u00D9\u00DA\u00DB\u0168\u1E78\u016A\u1E7A\u016C\u00DC\u01DB\u01D7\u01D5\u01D9\u1EE6\u016E\u0170\u01D3\u0214\u0216\u01AF\u1EEA\u1EE8\u1EEE\u1EEC\u1EF0\u1EE4\u1E72\u0172\u1E76\u1E74\u0244]/g,
    V: /[\u0056\u24CB\uFF36\u1E7C\u1E7E\u01B2\uA75E\u0245]/g,
    VY: /[\uA760]/g,
    W: /[\u0057\u24CC\uFF37\u1E80\u1E82\u0174\u1E86\u1E84\u1E88\u2C72]/g,
    X: /[\u0058\u24CD\uFF38\u1E8A\u1E8C]/g,
    Y: /[\u0059\u24CE\uFF39\u1EF2\u00DD\u0176\u1EF8\u0232\u1E8E\u0178\u1EF6\u1EF4\u01B3\u024E\u1EFE]/g,
    Z: /[\u005A\u24CF\uFF3A\u0179\u1E90\u017B\u017D\u1E92\u1E94\u01B5\u0224\u2C7F\u2C6B\uA762]/g,
    a: /[\u0061\u24D0\uFF41\u1E9A\u00E0\u00E1\u00E2\u1EA7\u1EA5\u1EAB\u1EA9\u00E3\u0101\u0103\u1EB1\u1EAF\u1EB5\u1EB3\u0227\u01E1\u00E4\u01DF\u1EA3\u00E5\u01FB\u01CE\u0201\u0203\u1EA1\u1EAD\u1EB7\u1E01\u0105\u2C65\u0250]/g,
    aa: /[\uA733]/g,
    ae: /[\u00E6\u01FD\u01E3]/g,
    ao: /[\uA735]/g,
    au: /[\uA737]/g,
    av: /[\uA739\uA73B]/g,
    ay: /[\uA73D]/g,
    b: /[\u0062\u24D1\uFF42\u1E03\u1E05\u1E07\u0180\u0183\u0253]/g,
    c: /[\u0063\u24D2\uFF43\u0107\u0109\u010B\u010D\u00E7\u1E09\u0188\u023C\uA73F\u2184]/g,
    d: /[\u0064\u24D3\uFF44\u1E0B\u010F\u1E0D\u1E11\u1E13\u1E0F\u0111\u018C\u0256\u0257\uA77A]/g,
    dz: /[\u01F3\u01C6]/g,
    e: /[\u0065\u24D4\uFF45\u00E8\u00E9\u00EA\u1EC1\u1EBF\u1EC5\u1EC3\u1EBD\u0113\u1E15\u1E17\u0115\u0117\u00EB\u1EBB\u011B\u0205\u0207\u1EB9\u1EC7\u0229\u1E1D\u0119\u1E19\u1E1B\u0247\u025B\u01DD]/g,
    f: /[\u0066\u24D5\uFF46\u1E1F\u0192\uA77C]/g,
    g: /[\u0067\u24D6\uFF47\u01F5\u011D\u1E21\u011F\u0121\u01E7\u0123\u01E5\u0260\uA7A1\u1D79\uA77F]/g,
    h: /[\u0068\u24D7\uFF48\u0125\u1E23\u1E27\u021F\u1E25\u1E29\u1E2B\u1E96\u0127\u2C68\u2C76\u0265]/g,
    hv: /[\u0195]/g,
    i: /[\u0069\u24D8\uFF49\u00EC\u00ED\u00EE\u0129\u012B\u012D\u00EF\u1E2F\u1EC9\u01D0\u0209\u020B\u1ECB\u012F\u1E2D\u0268\u0131]/g,
    j: /[\u006A\u24D9\uFF4A\u0135\u01F0\u0249]/g,
    k: /[\u006B\u24DA\uFF4B\u1E31\u01E9\u1E33\u0137\u1E35\u0199\u2C6A\uA741\uA743\uA745\uA7A3]/g,
    l: /[\u006C\u24DB\uFF4C\u0140\u013A\u013E\u1E37\u1E39\u013C\u1E3D\u1E3B\u017F\u0142\u019A\u026B\u2C61\uA749\uA781\uA747]/g,
    lj: /[\u01C9]/g,
    m: /[\u006D\u24DC\uFF4D\u1E3F\u1E41\u1E43\u0271\u026F]/g,
    n: /[\u006E\u24DD\uFF4E\u01F9\u0144\u00F1\u1E45\u0148\u1E47\u0146\u1E4B\u1E49\u019E\u0272\u0149\uA791\uA7A5]/g,
    nj: /[\u01CC]/g,
    o: /[\u006F\u24DE\uFF4F\u00F2\u00F3\u00F4\u1ED3\u1ED1\u1ED7\u1ED5\u00F5\u1E4D\u022D\u1E4F\u014D\u1E51\u1E53\u014F\u022F\u0231\u00F6\u022B\u1ECF\u0151\u01D2\u020D\u020F\u01A1\u1EDD\u1EDB\u1EE1\u1EDF\u1EE3\u1ECD\u1ED9\u01EB\u01ED\u00F8\u01FF\u0254\uA74B\uA74D\u0275]/g,
    oi: /[\u01A3]/g,
    ou: /[\u0223]/g,
    oo: /[\uA74F]/g,
    p: /[\u0070\u24DF\uFF50\u1E55\u1E57\u01A5\u1D7D\uA751\uA753\uA755]/g,
    q: /[\u0071\u24E0\uFF51\u024B\uA757\uA759]/g,
    r: /[\u0072\u24E1\uFF52\u0155\u1E59\u0159\u0211\u0213\u1E5B\u1E5D\u0157\u1E5F\u024D\u027D\uA75B\uA7A7\uA783]/g,
    s: /[\u0073\u24E2\uFF53\u00DF\u015B\u1E65\u015D\u1E61\u0161\u1E67\u1E63\u1E69\u0219\u015F\u023F\uA7A9\uA785\u1E9B]/g,
    t: /[\u0074\u24E3\uFF54\u1E6B\u1E97\u0165\u1E6D\u021B\u0163\u1E71\u1E6F\u0167\u01AD\u0288\u2C66\uA787]/g,
    tz: /[\uA729]/g,
    u: /[\u0075\u24E4\uFF55\u00F9\u00FA\u00FB\u0169\u1E79\u016B\u1E7B\u016D\u00FC\u01DC\u01D8\u01D6\u01DA\u1EE7\u016F\u0171\u01D4\u0215\u0217\u01B0\u1EEB\u1EE9\u1EEF\u1EED\u1EF1\u1EE5\u1E73\u0173\u1E77\u1E75\u0289]/g,
    v: /[\u0076\u24E5\uFF56\u1E7D\u1E7F\u028B\uA75F\u028C]/g,
    vy: /[\uA761]/g,
    w: /[\u0077\u24E6\uFF57\u1E81\u1E83\u0175\u1E87\u1E85\u1E98\u1E89\u2C73]/g,
    x: /[\u0078\u24E7\uFF58\u1E8B\u1E8D]/g,
    y: /[\u0079\u24E8\uFF59\u1EF3\u00FD\u0177\u1EF9\u0233\u1E8F\u00FF\u1EF7\u1E99\u1EF5\u01B4\u024F\u1EFF]/g,
    z: /[\u007A\u24E9\uFF5A\u017A\u1E91\u017C\u017E\u1E93\u1E95\u01B6\u0225\u0240\u2C6C\uA763]/g
  };

  /* src/core/types/array.coffee */;


  Array.isArray = function(a) {
    return Object.prototype.toString.call(a) === '[object Array]';
  };

  def(Array, {
    compact: function() {
      return this.select(function(el) {
        return el != null;
      });
    }
  });

  def(Array, {
    empty: function() {
      return this.length === 0;
    }
  });

  def(Array, {
    first: function() {
      if (this.length > 0) {
        return this[0];
      } else {
        return void 0;
      }
    }
  });

  def(Array, {
    flatten: function(level) {
      var a, el, _i, _len;
      if (level == null) {
        level = Infinity;
      }
      if (level < 0) {
        level = Infinity;
      }
      a = [];
      for (_i = 0, _len = this.length; _i < _len; _i++) {
        el = this[_i];
        if (Array.isArray(el) && level !== 0) {
          a = a.concat(el.flatten(level - 1));
        } else {
          a.push(el);
        }
      }
      return a;
    }
  });

  def(Array, {
    group: function(size) {
      var a;
      a = [];
      this.step(size, function() {
        var v;
        return a.push((function() {
          var _i, _len, _results;
          _results = [];
          for (_i = 0, _len = arguments.length; _i < _len; _i++) {
            v = arguments[_i];
            _results.push(v);
          }
          return _results;
        }).apply(this, arguments));
      });
      return a;
    }
  });

  def(Array, {
    last: function() {
      if (this.length > 0) {
        return this[this.length - 1];
      } else {
        return void 0;
      }
    }
  });

  def(Array, {
    max: function() {
      return Math.max.apply(null, this);
    }
  });

  def(Array, {
    min: function() {
      return Math.min.apply(null, this);
    }
  });

  def(Array, {
    reject: function(f) {
      var o, _i, _len, _results;
      _results = [];
      for (_i = 0, _len = this.length; _i < _len; _i++) {
        o = this[_i];
        if (!(typeof f === "function" ? f(o) : void 0)) {
          _results.push(o);
        }
      }
      return _results;
    }
  });

  def(Array, {
    rotate: function(amount) {
      var direction, i, out, range, _i, _j, _k, _len, _len1, _ref, _results;
      if (amount == null) {
        amount = 1;
      }
      if (amount === 0) {
        amount = 1;
      }
      direction = amount > 0;
      out = this.concat();
      range = (function() {
        _results = [];
        for (var _i = 0, _ref = Math.abs(amount) - 1; 0 <= _ref ? _i <= _ref : _i >= _ref; 0 <= _ref ? _i++ : _i--){ _results.push(_i); }
        return _results;
      }).apply(this);
      if (direction) {
        for (_j = 0, _len = range.length; _j < _len; _j++) {
          i = range[_j];
          out.push(out.shift());
        }
      } else {
        for (_k = 0, _len1 = range.length; _k < _len1; _k++) {
          i = range[_k];
          out.unshift(out.pop());
        }
      }
      return out;
    }
  });

  def(Array, {
    select: function(f) {
      var o, _i, _len, _results;
      _results = [];
      for (_i = 0, _len = this.length; _i < _len; _i++) {
        o = this[_i];
        if (typeof f === "function" ? f(o) : void 0) {
          _results.push(o);
        }
      }
      return _results;
    }
  });

  def(Array, {
    step: function(n, f) {
      var i, _i, _ref, _results;
      _results = [];
      for (i = _i = 0, _ref = Math.ceil(this.length / n) - 1; 0 <= _ref ? _i <= _ref : _i >= _ref; i = 0 <= _ref ? ++_i : --_i) {
        _results.push(f != null ? f.apply(this, this.slice(i * n, +(i * n + n - 1) + 1 || 9e9)) : void 0);
      }
      return _results;
    }
  });

  def(Array, {
    uniq: function() {
      var out, v, _i, _len;
      out = [];
      for (_i = 0, _len = this.length; _i < _len; _i++) {
        v = this[_i];
        if (__indexOf.call(out, v) < 0) {
          out.push(v);
        }
      }
      return out;
    }
  });

  /* src/core/mixin.coffee */;


  Mixin = function(mixin) {
    var included;
    included = mixin.included;
    mixin.included = function(base) {
      var _ref;
      if (typeof included === "function") {
        included(base);
      }
      if ((_ref = base.__mixins__) == null) {
        base.__mixins__ = [];
      }
      if (__indexOf.call(base.__mixins__, mixin) < 0) {
        return base.__mixins__.push(mixin);
      }
    };
    mixin.excluded = ["isMixinOf", "__definition__"];
    mixin.isMixinOf = function(object) {
      if (object.constructor.__mixins__ != null) {
        return __indexOf.call(object.constructor.__mixins__, mixin) >= 0;
      }
    };
    return mixin;
  };

  /* src/core/module.coffee */;


  /* src/core/module.coffee<Module> line:20 */;


  Module = (function() {
    /* src/core/module.coffee<Module.include> line:33 */;

    Module.include = function() {
      var excluded, hook, key, mixin, mixins, value, __excluded__, _i, _len;
      mixins = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
      this.__superOf__ = this.__superOf__.concat();
      __excluded__ = ["constructorHook", "included", "excluded"];
      for (_i = 0, _len = mixins.length; _i < _len; _i++) {
        mixin = mixins[_i];
        excluded = mixin.excluded != null ? __excluded__.concat(mixin.excluded) : __excluded__.concat();
        for (key in mixin) {
          value = mixin[key];
          if (!(__indexOf.call(excluded, key) < 0)) {
            continue;
          }
          this.prototype[key] = value;
          if (typeof value === 'function') {
            this.__superOf__[key] = this.__super__;
          }
        }
        if (mixin.constructorHook != null) {
          hook = mixin.constructorHook;
          this.__hooks__ = this.__hooks__.concat(hook);
        }
      }
      if (typeof mixin.included === "function") {
        mixin.included(this);
      }
      return this;
    };

    Module.__hooks__ = [];

    Module.__superOf__ = {};

    Module.prototype.preventConstructorHooksInModule = false;

    /* src/core/module.coffee<Module::constructor> line:103 */;


    function Module() {
      if (!this.preventConstructorHooksInModule) {
        this.triggerConstructorHooks();
      }
    }

    /* src/core/module.coffee<Module::triggerConstructorHooks> line:110 */;


    Module.prototype.triggerConstructorHooks = function() {
      var hook, _i, _len, _ref, _results;
      _ref = this.constructor.__hooks__;
      _results = [];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        hook = _ref[_i];
        _results.push(hook.call(this));
      }
      return _results;
    };

    /* src/core/module.coffee<Module::super> line:117 */;


    Module.prototype["super"] = function() {
      var args, method, _ref, _ref1;
      method = arguments[0], args = 2 <= arguments.length ? __slice.call(arguments, 1) : [];
      return (_ref = this.constructor.__superOf__[method]) != null ? (_ref1 = _ref[method]) != null ? _ref1.apply(this, args) : void 0 : void 0;
    };

    return Module;

  })();

  /* src/core/signal.coffee */;


  /* src/core/signal.coffee<Signal> line:11 */;


  Signal = (function() {
    /* src/core/signal.coffee<Signal::constructor> line:31 */;

    function Signal() {
      var signature;
      signature = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
      this.signature = signature;
      this.listeners = [];
      this.asyncListeners = 0;
    }

    /* src/core/signal.coffee<Signal::add> line:62 */;


    Signal.prototype.add = function(listener, context, priority) {
      if (priority == null) {
        priority = 0;
      }
      this.validate(listener);
      if (!this.registered(listener, context)) {
        this.listeners.push([listener, context, false, priority]);
        if (this.isAsync(listener)) {
          this.asyncListeners++;
        }
        return this.sortListeners();
      }
    };

    /* src/core/signal.coffee<Signal::addOnce> line:94 */;


    Signal.prototype.addOnce = function(listener, context, priority) {
      if (priority == null) {
        priority = 0;
      }
      this.validate(listener);
      if (!this.registered(listener, context)) {
        this.listeners.push([listener, context, true, priority]);
        if (this.isAsync(listener)) {
          this.asyncListeners++;
        }
        return this.sortListeners();
      }
    };

    /* src/core/signal.coffee<Signal::remove> line:110 */;


    Signal.prototype.remove = function(listener, context) {
      if (this.registered(listener, context)) {
        if (this.isAsync(listener)) {
          this.asyncListeners--;
        }
        return this.listeners.splice(this.indexOf(listener, context), 1);
      }
    };

    /* src/core/signal.coffee<Signal::removeAll> line:120 */;


    Signal.prototype.removeAll = function() {
      this.listeners = [];
      return this.asyncListeners = 0;
    };

    /* src/core/signal.coffee<Signal::indexOf> line:128 */;


    Signal.prototype.indexOf = function(listener, context) {
      var c, i, l, _i, _len, _ref, _ref1;
      _ref = this.listeners;
      for (i = _i = 0, _len = _ref.length; _i < _len; i = ++_i) {
        _ref1 = _ref[i], l = _ref1[0], c = _ref1[1];
        if (listener === l && context === c) {
          return i;
        }
      }
      return -1;
    };

    /* src/core/signal.coffee<Signal::registered> line:136 */;


    Signal.prototype.registered = function(listener, context) {
      return this.indexOf(listener, context) !== -1;
    };

    /* src/core/signal.coffee<Signal::hasListeners> line:142 */;


    Signal.prototype.hasListeners = function() {
      return this.listeners.length !== 0;
    };

    /* src/core/signal.coffee<Signal::sortListeners> line:149 */;


    Signal.prototype.sortListeners = function() {
      if (this.listeners.length <= 1) {
        return;
      }
      return this.listeners.sort(function(a, b) {
        var pA, pB, _ref;
        _ref = [a[3], b[3]], pA = _ref[0], pB = _ref[1];
        if (pA < pB) {
          return 1;
        } else if (pB < pA) {
          return -1;
        } else {
          return 0;
        }
      });
    };

    /* src/core/signal.coffee<Signal::validate> line:165 */;


    Signal.prototype.validate = function(listener) {
      var args, listenerSignature, m, re, s1, s2, signature;
      if (this.signature.length > 0) {
        re = /[^(]+\(([^)]+)\).*$/m;
        listenerSignature = Function.prototype.toString.call(listener).split('\n').shift();
        signature = listenerSignature.replace(re, '$1');
        args = signature.split(/\s*,\s*/g);
        if (args.first() === '') {
          args.shift();
        }
        if (args.last() === 'callback') {
          args.pop();
        }
        s1 = this.signature.join();
        s2 = args.join();
        m = "The listener " + listener + " doesn't match the signal's signature " + s1;
        if (s2 !== s1) {
          throw new Error(m);
        }
      }
    };

    /* src/core/signal.coffee<Signal::isAsync> line:187 */;


    Signal.prototype.isAsync = function(listener) {
      return Function.prototype.toString.call(listener).indexOf('callback)') !== -1;
    };

    /* src/core/signal.coffee<Signal::dispatch> line:216 */;


    Signal.prototype.dispatch = function() {
      var args, callback, context, listener, listeners, next, once, priority, _i, _j, _len, _ref,
        _this = this;
      args = 2 <= arguments.length ? __slice.call(arguments, 0, _i = arguments.length - 1) : (_i = 0, []), callback = arguments[_i++];
      if (typeof callback !== 'function') {
        args.push(callback);
        callback = null;
      }
      listeners = this.listeners.concat();
      if (this.asyncListeners > 0) {
        next = function(callback) {
          var context, listener, once, priority, _ref;
          if (listeners.length) {
            _ref = listeners.shift(), listener = _ref[0], context = _ref[1], once = _ref[2], priority = _ref[3];
            if (_this.isAsync(listener)) {
              return listener.apply(context, args.concat(function() {
                if (once) {
                  _this.remove(listener, context);
                }
                return next(callback);
              }));
            } else {
              listener.apply(context, args);
              if (once) {
                _this.remove(listener, context);
              }
              return next(callback);
            }
          } else {
            return typeof callback === "function" ? callback() : void 0;
          }
        };
        return next(callback);
      } else {
        for (_j = 0, _len = listeners.length; _j < _len; _j++) {
          _ref = listeners[_j], listener = _ref[0], context = _ref[1], once = _ref[2], priority = _ref[3];
          listener.apply(context, arguments);
          if (once) {
            this.remove(listener, context);
          }
        }
        return typeof callback === "function" ? callback() : void 0;
      }
    };

    return Signal;

  })();

  /* test/fixtures/tasks/package/invalid.coffee */;


  f(0);

  this.neat.core.def = def;

  this.neat.core.Mixin = Mixin;

  this.neat.core.Module = Module;

  this.neat.core.Signal = Signal;

}).call(this);

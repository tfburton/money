fs = require 'fs'
Neat = require '../../../neat'
{run} = require '../../../utils/commands'
{find} = require '../../../utils/files'

VOWS = "#{Neat.neatRoot}/node_modules/.bin/vows"

module.exports = (config) ->
  return
  config.engines.tests.vows = (callback) ->
    unless fs.existsSync VOWS
      msg = """#{red "Can't find vows module"}

               Run #{yellow 'neat install'} to install the dependencies."""
      return callback? new Error msg

    find 'coffee', ["#{Neat.root}/test/vows"], (err, files) ->
      run VOWS, files, callback
